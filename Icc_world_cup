with cte as (
select  Team_1 team_name, case when Winner = Team_1 then 1 else 0 end as win_flag from icc_world_cup
union all 
  select  Team_2 team_name, case when Winner = Team_2 then 1 else 0 end as win_flag from icc_world_cup
) 
select team_name, count(1) as matches_played,sum(win_flag) win,count(1)-sum(win_flag) as loss from cte
group by team_name

